// For format details, see https://aka.ms/devcontainer.json. For config options, see the
// README at: https://github.com/devcontainers/templates/tree/main/src/ubuntu
{
	"name": "dev container",
	"dockerFile": "Dockerfile",
	"context": "..",
	"customizations": {
		"vscode": {
			"extensions": [
				"ms-azuretools.vscode-docker",
				"humao.rest-client", //                     REST client (for http files)
				"bazelbuild.vscode-bazel", //               Tooling for bazel
				"streetsidesoftware.code-spell-checker", // Spell checker 
				"GitHub.copilot",
				"GitHub.copilot-labs",
				"GitHub.copilot-chat",
				"ms-vscode.cpptools", //        C/C++: C/C++ IntelliSense, debugging, and code browsing.
				"ms-vscode.cmake-tools", //     C/C++: cmake tools
				"llvm-vs-code-extensions.vscode-clangd", // C/C++: clangd language server
				"ms-python.python", //          Python: Python Language Basics
				"ms-python.vscode-pylance", //  Python: Pylance
				"njpwerner.autodocstring", //   Python: Autodocstrings -- under evaluation
				"ms-python.autopep8", //        Python: Autopep8 -- under evaluation
				"nwgh.bandit", //               Python: Bandit -- under evaluation
				"ms-python.flake8", //          Python: Flake8 -- under evaluation
				"ms-python.isort", //           Python: Isort -- under evaluation
				"ms-python.pylint", //          Python: Pylint -- under evaluation
				"samuelcolvin.jinjahtml", //    Python: Jinja -- under evaluation
				"redhat.vscode-xml", //         xml language support
				"danielroedl.meld-diff", //     Compares files with meld
				"mtsmfm.vscode-stl-viewer", //  stl file viewer
				"ms-iot.vscode-ros" //          ROS1 extension -- under evaluation
			]
		}
	},
	"runArgs": [
		"--network=host",
		"-v",
		"/var/run/docker.sock:/var/run/docker.sock",
		"-v",
		"/tmp/.X11-unix:/tmp/.X11-unix",
		"-e",
		"DISPLAY=unix${env:DISPLAY}",
		// Device needed for RVIZ in ros noetic
		"--device",
		"/dev/dri:/dev/dri",
		// "--device",
		// "/dev/input/js0:/dev/input/js0",
		"-v",
		"${env:HOME}/.ssh:/home/dev/.ssh:ro",
		// "${env:HOME}/.ssh:/home/dev/.ssh-localhost:ro",
		"-v",
		"${env:HOME}/data:/data"
	],
	"portsAttributes": {
		"11311": {
			"label": "test"
		}
	}
}
// " --privileged"
// " --network=host" #Network host clashes with devcontainer. It can cause infinite loops. https://github.com/microsoft/vscode-remote-release/issues/4922
// "--memory=16g",
// " --cpus=8",
// " --ipc=host",
// " --privileged",
// " -e ROS_MASTER_URI=http://localhost:11311",
// "--ipc=host"
// "-v /tmp/coredumps:/tmp/coredumps"
// "${env:HOME}/.docker:/home/dev/.docker",
// " --device=/dev/input/js0" # Joystick / xbox controller
// "- v ${ssh_auth_sock}:/ssh-agent"
//
// Issues with screen - try running xhost +"local:docker@" before starting docker to grant access to the display
// https://github.com/jessfraz/dockerfiles/issues/329